{% extends "base.html" %}
{% block title %}Chat Users{% endblock %}

{% block content %}
<h2>Chat with Users</h2>

<!-- Search box to filter users -->
<input type="text" id="userSearch" placeholder="Search users..." onkeyup="filterUsers()" style="margin-bottom: 12px; padding: 6px; width: 100%; max-width: 400px;">

<div class="user-list-container" style="max-width: 400px;">
  <ul id="userList" style="list-style: none; padding: 0;">
    {% for user in users %}
      <li style="margin-bottom: 8px; padding: 8px; border: 1px solid #ddd; border-radius: 6px;">
        <a href="{{ url_for('chat_with', user_id=user.id) }}" style="text-decoration: none; color: #333;">
          <!-- User status circle -->
          <span style="display: inline-block; width: 10px; height: 10px; border-radius: 50%; 
            background-color: {% if user.is_online %}green{% else %}gray{% endif %}; 
            margin-right: 8px;"></span>
          {{ user.username }}
        </a>
      </li>
    {% else %}
      <li>No other users available to chat.</li>
    {% endfor %}
  </ul>
</div>

<script>
  // Simple JS to filter users by typing in the search box
  function filterUsers() {
    const input = document.getElementById('userSearch');
    const filter = input.value.toLowerCase();
    const ul = document.getElementById('userList');
    const li = ul.getElementsByTagName('li');

    for (let i = 0; i < li.length; i++) {
      let a = li[i].getElementsByTagName('a')[0];
      if (a) {
        let txtValue = a.textContent || a.innerText;
        if (txtValue.toLowerCase().indexOf(filter) > -1) {
          li[i].style.display = "";
        } else {
          li[i].style.display = "none";
        }
      }
    }
  }
</script>
{% endblock %}
